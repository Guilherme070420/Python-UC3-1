# 07.02 - Introdu√ß√£o ao Framework Django

Esta aula apresenta as principais caracter√≠sticas do framework Django, guia a instala√ß√£o e configura√ß√£o do ambiente de desenvolvimento e detalha a cria√ß√£o de um projeto Django, incluindo sua estrutura. 

Al√©m disso, s√£o propostos desafios pr√°ticos para consolidar o aprendizado.

## 1. Apresenta√ß√£o do Framework 

O `Django` √© um **framework** web de alto n√≠vel para `Python`, projetado para desenvolvimento r√°pido, seguro e escal√°vel. 

Suas principais caracter√≠sticas incluem:

* **Arquitetura MVT (Model-View-Template)**: Separa√ß√£o clara entre modelos de dados, l√≥gica de neg√≥cios e apresenta√ß√£o.
* **ORM (Object-Relational Mapping)**: Permite interagir com bancos de dados usando objetos Python, sem escrever SQL diretamente.
* **Admin Autom√°tico**: Interface administrativa gerada automaticamente para gerenciar dados.
* **Seguran√ßa Integrada**: Prote√ß√£o contra vulnerabilidades como SQL Injection, XSS e CSRF.
* **Escalabilidade**: Usado por grandes empresas como Instagram e Pinterest.
* **DRY (Don't Repeat Yourself)**: Promove a reutiliza√ß√£o de c√≥digo.
* **Baterias Inclu√≠das**: Inclui ferramentas para autentica√ß√£o, formul√°rios, URLs, templates, entre outros.

Django 5.2, a vers√£o mais recente em julho de 2025, traz melhorias em desempenho, suporte a Python 3.12 e novos recursos, como valida√ß√£o avan√ßada de formul√°rios e integra√ß√£o otimizada com bancos de dados ass√≠ncronos.

## 2. Instala√ß√£o e Configura√ß√£o do Ambiente

### 2.1 Pr√©-requisitos

* Python 3.12 instalado (verifique com `python --version`).
* Gerenciador de pacotes `pip` atualizado.
* Ambiente virtual para isolar depend√™ncias.

### 2.2 Passos para Configura√ß√£o

1. **Criar um ambiente virtual**:

   ```bash
   python -m venv venv
   source venv/bin/activate  # Linux/Mac
   venv\Scripts\activate     # Windows
   ```

2. **Instalar o Django 5.2**:

   ```bash
   pip install django==5.2
   ```

3. **Verificar a instala√ß√£o**:

   ```bash
   django-admin --version
   ```

   Deve retornar `5.2`.

4. **Configurar ferramentas adicionais (opcional)**:

   * Instale o `django-extensions` para funcionalidades extras:
     ```bash
     pip install django-extensions
     ```

> O pacote django-extensions √© uma cole√ß√£o de ferramentas adicionais para o framework Django que amplia suas funcionalidades, facilitando o desenvolvimento, depura√ß√£o e manuten√ß√£o de projetos. Ele n√£o √© essencial, mas √© altamente recomendado para desenvolvedores que buscam produtividade e recursos avan√ßados

   * Configure um editor de c√≥digo (VS Code, PyCharm) com extens√µes para **Python** e **Django**.
  

## 3. Criando um Projeto Django e Sua Estrutura

### 3.1 Criando um Projeto

1. Crie um novo projeto Django:

   ```bash
   django-admin startproject meu_projeto
   cd meu_projeto
   ```

2. **Estrutura do Projeto**:\
   Ap√≥s executar o comando, a estrutura ser√°:

   ```
   meu_projeto/
   ‚îú‚îÄ‚îÄ manage.py
   ‚îî‚îÄ‚îÄ meu_projeto/
       ‚îú‚îÄ‚îÄ __init__.py
       ‚îú‚îÄ‚îÄ asgi.py
       ‚îú‚îÄ‚îÄ settings.py
       ‚îú‚îÄ‚îÄ urls.py
       ‚îú‚îÄ‚îÄ wsgi.py
   ```

   * `manage.py`: Script para gerenciar o projeto (migra√ß√µes, servidor, etc.).

   * `meu_projeto/`:

     * `__init__.py`: Indica que √© um pacote Python.
     * `settings.py`: Configura√ß√µes do projeto (banco de dados, apps, etc.).
     * `urls.py`: Mapeamento de URLs para views.
     * `asgi.py`/`wsgi.py`: Entradas para servidores ASGI/WSGI.

3. **Iniciar o servidor de desenvolvimento**:

   ```bash
   python manage.py runserver
   ```

   Acesse `http://127.0.0.1:8000/` no navegador para ver a p√°gina inicial do Django.

4. **Mudan√ßa de porta (se necess√°rio)**:\
   Caso a porta 8000 esteja em uso, especifique outra porta:

   ```bash
   python manage.py runserver 8080
   ```

   Acesse `http://127.0.0.1:8080/` no navegador.


## 4. Novo Projeto Django

### 4.1. **Criar um projeto chamado `blog`**:

**Comando:**
```bash
django-admin startproject blog
cd blog
```
- Como n√£o √© informado o diret√≥rio onde o projeto deve ser criado, s√£o criadas duas pastas denominadas `blog`

- Para criar um novo projeto na pasta atual utilize o comando abaixo:

**Comando:**
```bash
django-admin startproject blog  .
cd blog
```  

### 4.2. Arquivo `settings.py`:

O arquivo `settings.py` √© o cora√ß√£o da configura√ß√£o de um projeto Django, contendo defini√ß√µes globais como aplicativos instalados, configura√ß√µes de banco de dados, middleware, templates, configura√ß√µes de seguran√ßa, entre outros. Ele √© gerado automaticamente na pasta do projeto e segue um formato padr√£o, que pode ser personalizado conforme necess√°rio.

Abra o projeto em um editor de c√≥digo e acesse a pasta `blog\blog`,  analise o arquivo `settings.py` e identifique as configura√ß√µes padr√£o, como `INSTALLED_APPS` e `DATABASES`.
  
#### 4.2.1 Se√ß√£o INSTALLED_APPS

Especifica os aplicativos **Django** ativos no projeto. Cada aplicativo listado contribui com **modelos**, **views**, **templates** e outros recursos. 

A configura√ß√£o padr√£o inclui os aplicativos principais do Django, que fornecem funcionalidades essenciais.

**Configura√ß√£o Padr√£o** (em um projeto rec√©m-criado):
```python
INSTALLED_APPS = [
    'django.contrib.admin',          # Interface administrativa
    'django.contrib.auth',           # Sistema de autentica√ß√£o
    'django.contrib.contenttypes',   # Framework para tipos de conte√∫do
    'django.contrib.sessions',       # Gerenciamento de sess√µes
    'django.contrib.messages',       # Sistema de mensagens para o usu√°rio
    'django.contrib.staticfiles',    # Gerenciamento de arquivos est√°ticos
]
```

**An√°lise dos Componentes**:

- **`django.contrib.admin`**: 
    - Fornece a **interface administrativa** autom√°tica, acess√≠vel em `/admin/`, para gerenciar modelos.

- **`django.contrib.auth`**: 
    - Inclui modelos e funcionalidades para **autentica√ß√£o de usu√°rios** (ex.: `User`, `Group`, login/logout).

- **`django.contrib.contenttypes`**: 
    - Permite **associa√ß√µes** gen√©ricas **entre modelos**, usado por outros aplicativos como o admin.

- **`django.contrib.sessions`**: 
    - Habilita o suporte a **sess√µes**, permitindo **armazenar dados entre requisi√ß√µes**.

- **`django.contrib.messages`**: 
    - Fornece um sistema para exibir **mensagens tempor√°rias** (ex.: "Registro salvo com sucesso").
    
- **`django.contrib.staticfiles`**: 
    - Gerencia **arquivos est√°ticos** (CSS, JavaScript, imagens) usados em templates HTML5.

**Observa√ß√£o**:
- Voc√™ pode adicionar aplicativos personalizados (ex.: `'posts'`) ou de terceiros (ex.: `'django_extensions'`) a essa lista.
- A ordem em `INSTALLED_APPS` pode afetar a prioridade de templates e arquivos est√°ticos.


#### 4.2.2 Se√ß√£o DATABASES

A configura√ß√£o `DATABASES` define os bancos de dados usados pelo projeto. Por padr√£o, o Django configura o SQLite, um banco leve e embutido, ideal para desenvolvimento inicial.

**Configura√ß√£o Padr√£o**:
```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': BASE_DIR / 'db.sqlite3',
    }
}
```

**An√°lise dos Componentes**:

- **`ENGINE`**: 
    - Especifica o **backend** do banco de dados. 
    - O valor `'django.db.backends.sqlite3'` indica o uso do SQLite.
    
- **`NAME`**: 
    - Define o **caminho para o arquivo** do banco de dados SQLite. 
    - O `BASE_DIR / 'db.sqlite3'` aponta para um arquivo `db.sqlite3` na raiz do projeto, gerado automaticamente.

- **Outras op√ß√µes** (n√£o presentes por padr√£o, mas configur√°veis):
  - Para bancos como PostgreSQL ou MySQL, voc√™ alteraria o `ENGINE` (ex.: `'django.db.backends.postgresql'`) e adicionaria chaves como `HOST`, `PORT`, `USER` e `PASSWORD`.

**Exemplo de Configura√ß√£o para PostgreSQL** (n√£o padr√£o, mas comum em produ√ß√£o):
```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'meu_banco',
        'USER': 'meu_usuario',
        'PASSWORD': 'minha_senha',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
```

#### 4.2.3 Outras Configura√ß√µes Relevantes

Para fornecer uma vis√£o mais completa, destacamos outras configura√ß√µes:

##### üîñ **`SECRET_KEY`**:
  ```python
  SECRET_KEY = 'django-insecure-algum_valor_aleatorio'
  ```
  - Uma chave usada para seguran√ßa criptogr√°fica. 
  - O prefixo `django-insecure-` indica que √© insegura para produ√ß√£o. 
  - Use `django-extensions` (`generate_secret_key`) para criar uma chave segura.
  

##### üîñ  **`DEBUG`**:
  ```python
  DEBUG = True
  ```
  - Ativado por padr√£o para desenvolvimento, exibe erros detalhados no navegador. 
  - Deve ser definido como `False` em produ√ß√£o.

##### üîñ  **`ALLOWED_HOSTS`**:

  ```python
  ALLOWED_HOSTS = []
  ```
  - Lista vazia por padr√£o, permitindo apenas `localhost` em desenvolvimento. 
  - Em produ√ß√£o, adicione dom√≠nios (ex.: `['meusite.com', 'www.meusite.com']`).

##### üîñ  **`MIDDLEWARE`**:

  ```python
  MIDDLEWARE = [
      'django.middleware.security.SecurityMiddleware',
      'django.contrib.sessions.middleware.SessionMiddleware',
      'django.middleware.common.CommonMiddleware',
      'django.middleware.csrf.CsrfViewMiddleware',
      'django.contrib.auth.middleware.AuthenticationMiddleware',
      'django.contrib.messages.middleware.MessageMiddleware',
      'django.middleware.clickjacking.XFrameOptionsMiddleware',
  ]
  ```
  
  - Define `middlewares` para processamento de requisi√ß√µes/respostas, como seguran√ßa, sess√µes e prote√ß√£o CSRF.

##### üîñ  **`TEMPLATES`**:

  ```python
  TEMPLATES = [
      {
          'BACKEND': 'django.template.backends.django.DjangoTemplates',
          'DIRS': [],
          'APP_DIRS': True,
          'OPTIONS': {
              'context_processors': [
                  'django.template.context_processors.debug',
                  'django.template.context_processors.request',
                  'django.contrib.auth.context_processors.auth',
                  'django.contrib.messages.context_processors.messages',
              ],
          },
      },
  ]
  ```
  
- `BACKEND`
    - **Valor Padr√£o**: 'django.template.backends.django.DjangoTemplates'
    - **Descri√ß√£o**: Especifica o motor de template a ser usado. O valor padr√£o indica que o Django usar√° seu pr√≥prio sistema de templates, que √© compat√≠vel com HTML5 e permite a cria√ß√£o de templates din√¢micos com sintaxe como `{{ variavel }}` e `{% tag %}`.
   
- `DIRS`
    - **Valor Padr√£o**: `[]`
    - **Descri√ß√£o**: 
        - Lista de diret√≥rios onde o Django procurar√° templates fora dos aplicativos (ou seja, templates globais). 
        - Por padr√£o, est√° vazia, significando que o Django s√≥ busca templates nos diret√≥rios `templates/` de cada aplicativo listado em `INSTALLED_APPS`.
    - **Uso**:
        - Para adicionar templates globais (ex.: um template base para todo o projeto), adicione o caminho ao diret√≥rio:
            ```python
            'DIRS': [BASE_DIR / 'templates'],
            ```
    - **Exemplo**: Crie um diret√≥rio `templates/` na raiz do projeto e adicione um arquivo como `base.html` para ser usado como base em v√°rias p√°ginas.
        
    - **Integra√ß√£o com Bootstrap**: Um diret√≥rio global pode conter um template base com a estrutura do Bootstrap:
  ```html
  <!-- templates/base.html -->
  <!DOCTYPE html>
  <html lang="pt-br">
  <head>
      <meta charset="UTF-8">
      <title>{% block title %}Meu Site{% endblock %}</title>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body>
      <div class="container">
          {% block content %}{% endblock %}
      </div>
  </body>
  </html>
  ```
   
   
  - `APP_DIRS: True`:
    - Permite que templates sejam buscados nos diret√≥rios dos aplicativos.
    - **Valor Padr√£o**: `True`
    - **Descri√ß√£o**: 
        - Quando `True`, o Django procura automaticamente templates nos subdiret√≥rios `templates/` de cada aplicativo listado em `INSTALLED_APPS`. 
        - Por exemplo, se voc√™ tem um app chamado `posts`, o Django buscar√° templates em `posts/templates/`.
    - **Uso**:
        - Essa configura√ß√£o √© conveniente para organizar templates por aplicativo, mantendo a modularidade.
        - Para desativar essa busca autom√°tica (raro), defina como `False` e especifique todos os diret√≥rios em `DIRS`.
    - **Exemplo**: Em um app `posts`, crie `posts/templates/posts/home.html` para renderizar uma p√°gina espec√≠fica:
  ```html
  <!-- posts/templates/posts/home.html -->
  {% extends 'base.html' %}
  {% block content %}
      <h1 class="mt-5">Bem-vindo ao Blog</h1>
      <p class="lead">Conte√∫do din√¢mico aqui.</p>
  {% endblock %}
  ```
  

##### üîñ  **`STATIC_URL`**:
  ```python
  STATIC_URL = 'static/'
  ```
  - Define o prefixo para arquivos est√°ticos (CSS, JS), usados com Bootstrap e outros frameworks front-end.

##### üîñ  **`LANGUAGE_CODE` e `TIME_ZONE`**:
  ```python
  LANGUAGE_CODE = 'en-us'
  TIME_ZONE = 'UTC'
  ```
  - Configura idioma e fuso hor√°rio padr√£o. 
  Para projetos em portugu√™s, altere para `'pt-br'` e, por exemplo, `'America/Sao_Paulo'`.


#### 4.2.4. **Executar o servidor**:

   ```bash
   python manage.py runserver
   ```

   * Acesse `http://127.0.0.1:8000/` e verifique a p√°gina inicial do Django.
   * Se a porta 8000 estiver ocupada, use:
     ```bash
     python manage.py runserver 8081
     ```
     Acesse `http://127.0.0.1:8081/`.


### 4.2 **Criar um app inicial**:

Para o servidor e utilize o arquivo `manage.py` para criar o novo aplicativo

```bash
python manage.py startapp posts
```

Adicione `'posts'` √† lista `INSTALLED_APPS` em `settings.py`.

1. **Abra o arquivo `settings.py`**:
   - Localize o arquivo em `blog/blog/settings.py` (assumindo que o projeto foi criado com `django-admin startproject blog`).
   - Use um editor como VS Code ou PyCharm para facilitar a leitura.

2. **Verifique `INSTALLED_APPS`**:
   - Confirme a presen√ßa dos aplicativos padr√£o listados acima.
   - Se voc√™ adicionou um app como `posts` (com `python manage.py startapp posts`), adicione-o manualmente:
     ```python
     INSTALLED_APPS = [
         ...
         'posts',
     ]
     ```
 3. **Verifique `DATABASES`**:
 
    - Confirme que o SQLite est√° configurado como padr√£o.
    
    - Verifique o arquivo `db.sqlite3` na raiz do projeto ap√≥s rodar:

      ```python
      python manage.py migrate
        ```

4. **Teste a Configura√ß√£o**:
   - Execute o servidor:
   
     ```bash
     python manage.py runserver
     ```
   
   - Acesse `http://127.0.0.1:8000/` para confirmar que o projeto est√° funcional.  

#### 4.2.1. **Testar a configura√ß√£o**:

1. Crie uma view simples no app `posts` e mapeie uma URL para ela.

1.  Exemplo de c√≥digo para `posts/views.py`:

    ```python
    from django.shortcuts import render
    from django.http import HttpResponse
    
     def home(request):
         return HttpResponse("Bem-vindo ao Blog!")
     ```
 
 1. Crie o arquivo `posts/urls.py` com uma URL para a view home.

    ```python 
    from django.urls import path
    from .views import home
    
    
        app_name = 'posts'
    
    urlpatterns = [
        path('', home, name='home'),
    ]
    ```

    - **`app_name = 'posts'`**: Define um namespace para evitar conflitos de nomes de URLs entre aplicativos. Isso permite usar `{% url 'posts:home' %}` em templates.
    - **`path('', home, name='home')`**: Mapeia a URL raiz do aplicativo (ex.: `/posts/`) para a view `home`.

 
 
 
1. Atualize `blog/urls.py`:

    Modifique o arquivo `blog/urls.py` para incluir as URLs do aplicativo `posts`.
    
    ```python
    from django.contrib import admin
    from django.urls import path, include
    
    urlpatterns = [
        path('admin/', admin.site.urls),
        path('posts/', include('posts.urls')),
    ]
    ```
    
    - **`include('posts.urls')`**: Delega todas as URLs que come√ßam com `posts/` para o arquivo `posts/urls.py`.
    
    - Exemplo: A URL `http://127.0.0.1:8000/posts/` ser√° resolvida pela view `home` do aplicativo `posts`.
     
 
 1. Reinicie o servidor e acesse `http://127.0.0.1:8000/` (ou a porta configurada).
